<?php

include_once('dlr_groups.features.inc');

/**
 * Implementation of hook_context_links_alter().
 * 
 * Have only one context link button appear for dlr group nodes when the info tab is selected: Edit the node.
 * 
 */

function dlr_groups_context_links_alter(&$links) {
  $path_query = $_GET['q'];
  if (context_get('context', 'dlr_groups_context_links')) {
    $links = array();
    // The context_links button appaear for info page and pages with node in the url but not node edit
    if($path_query === "info" || (strpos($path_query, "node") !== FALSE && strpos($path_query, "edit") === FALSE)) {
      /* @var $active_space spaces_og class */
      $active_space = spaces_get_space();
      $item = menu_get_item('node/'.spaces_get_space()->id.'/edit');
      if ($item['access']) {
        $links['admin_groups'] = array('title' => t('Edit @type', array('@type' => $active_space->group->type)), 'href' => $item['href']);
      }
    }
  }
}

/**
 * Implementation of hook_menu_alter().
 * 
 * Hide certain menu items that appear as tabs.
 * 
 */
function dlr_groups_menu_alter(&$items){
  $items['node/%node/buildmodes']['type'] = MENU_CALLBACK;
  $items['node/%node/features']['type'] = MENU_CALLBACK;
}
